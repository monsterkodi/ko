// koffee 1.3.0
var _,
    indexOf = [].indexOf;

_ = require('kxk')._;

module.exports = {
    deleteSelectionOrCursorLines: function() {
        this["do"].start();
        if (!this["do"].numSelections()) {
            this.selectMoreLines();
        }
        this.deleteSelection();
        return this["do"].end();
    },
    deleteSelection: function(opt) {
        var c, csel, ep, i, j, joinLines, k, l, len, len1, len2, len3, len4, len5, len6, lineSelected, m, n, nc, newCursors, o, oldSelections, ref, ref1, ref2, ref3, ref4, ref5, ref6, ref7, rg, s, sp;
        if (opt == null) {
            opt = {
                deleteLines: true
            };
        }
        this["do"].start();
        if (this["do"].numSelections()) {
            newCursors = this["do"].cursors();
            oldSelections = this["do"].selections();
            joinLines = [];
            ref = this["do"].cursors().reverse();
            for (i = 0, len = ref.length; i < len; i++) {
                c = ref[i];
                if (opt.deleteLines) {
                    csel = this.continuousSelectionAtPosInRanges(c, oldSelections);
                } else {
                    rg = rangeAtPosInRanges(c, oldSelections);
                    if (rg != null) {
                        csel = [rangeStartPos(rg), rangeEndPos(rg)];
                    }
                }
                if (csel != null) {
                    sp = csel[0], ep = csel[1];
                    ref1 = positionsBetweenPosAndPosInPositions(sp, ep, newCursors);
                    for (j = 0, len1 = ref1.length; j < len1; j++) {
                        nc = ref1[j];
                        cursorSet(nc, sp);
                    }
                    if (sp[1] < ep[1] && sp[0] > 0 && ep[0] < this["do"].line(ep[1]).length) {
                        joinLines.push(sp[1]);
                        ref2 = positionsAfterLineColInPositions(ep[1], ep[0], newCursors);
                        for (k = 0, len2 = ref2.length; k < len2; k++) {
                            nc = ref2[k];
                            cursorSet(nc, sp[0] + nc[0] - ep[0], sp[1]);
                        }
                    }
                }
            }
            ref3 = this["do"].selections().reverse();
            for (l = 0, len3 = ref3.length; l < len3; l++) {
                s = ref3[l];
                if (s[0] >= this["do"].numLines()) {
                    continue;
                }
                lineSelected = s[1][0] === 0 && s[1][1] === this["do"].line(s[0]).length;
                if (lineSelected && opt.deleteLines && this["do"].numLines() > 1) {
                    this["do"]["delete"](s[0]);
                    ref4 = positionsBelowLineIndexInPositions(s[0], newCursors);
                    for (m = 0, len4 = ref4.length; m < len4; m++) {
                        nc = ref4[m];
                        cursorDelta(nc, 0, -1);
                    }
                } else {
                    if (s[0] >= this["do"].numLines()) {
                        continue;
                    }
                    this["do"].change(s[0], this["do"].line(s[0]).splice(s[1][0], s[1][1] - s[1][0]));
                    ref5 = positionsAfterLineColInPositions(s[0], s[1][1], newCursors);
                    for (n = 0, len5 = ref5.length; n < len5; n++) {
                        nc = ref5[n];
                        cursorDelta(nc, -(s[1][1] - s[1][0]));
                    }
                }
                if (ref6 = s[0], indexOf.call(joinLines, ref6) >= 0) {
                    this["do"].change(s[0], this["do"].line(s[0]) + this["do"].line(s[0] + 1));
                    this["do"]["delete"](s[0] + 1);
                    ref7 = positionsBelowLineIndexInPositions(s[0], newCursors);
                    for (o = 0, len6 = ref7.length; o < len6; o++) {
                        nc = ref7[o];
                        cursorDelta(nc, 0, -1);
                    }
                    _.pull(joinLines, s[0]);
                }
            }
            this["do"].select([]);
            this["do"].setCursors(newCursors);
            this.endSelection();
        }
        return this["do"].end();
    },
    continuousSelectionAtPosInRanges: function(p, sel) {
        var ep, nlr, plr, r, sil, sp;
        r = rangeAtPosInRanges(p, sel);
        if (r && lengthOfRange(r)) {
            sp = rangeStartPos(r);
            while ((sp[0] === 0) && (sp[1] > 0)) {
                plr = this.rangeForLineAtIndex(sp[1] - 1);
                sil = rangesAtLineIndexInRanges(sp[1] - 1, sel);
                if (sil.length === 1 && isSameRange(sil[0], plr)) {
                    sp = rangeStartPos(plr);
                } else if (sil.length && _.last(sil)[1][1] === plr[1][1]) {
                    sp = rangeStartPos(_.last(sil));
                } else {
                    break;
                }
            }
            ep = rangeEndPos(r);
            while ((ep[0] === this.line(ep[1]).length) && (ep[1] < this.numLines() - 1)) {
                nlr = this.rangeForLineAtIndex(ep[1] + 1);
                sil = rangesAtLineIndexInRanges(ep[1] + 1, sel);
                if (sil.length === 1 && isSameRange(sil[0], nlr)) {
                    ep = rangeEndPos(nlr);
                } else if (sil.length && _.first(sil)[1][0] === 0) {
                    ep = rangeEndPos(_.first(sil));
                } else {
                    break;
                }
            }
            return [sp, ep];
        }
    }
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGVsZXRlc2VsZWN0aW9uLmpzIiwic291cmNlUm9vdCI6Ii4iLCJzb3VyY2VzIjpbIiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBT0EsSUFBQSxDQUFBO0lBQUE7O0FBQUUsSUFBTSxPQUFBLENBQVEsS0FBUjs7QUFFUixNQUFNLENBQUMsT0FBUCxHQUVJO0lBQUEsNEJBQUEsRUFBOEIsU0FBQTtRQUUxQixJQUFDLEVBQUEsRUFBQSxFQUFFLENBQUMsS0FBSixDQUFBO1FBQ0EsSUFBRyxDQUFJLElBQUMsRUFBQSxFQUFBLEVBQUUsQ0FBQyxhQUFKLENBQUEsQ0FBUDtZQUNJLElBQUMsQ0FBQSxlQUFELENBQUEsRUFESjs7UUFFQSxJQUFDLENBQUEsZUFBRCxDQUFBO2VBQ0EsSUFBQyxFQUFBLEVBQUEsRUFBRSxDQUFDLEdBQUosQ0FBQTtJQU4wQixDQUE5QjtJQVFBLGVBQUEsRUFBaUIsU0FBQyxHQUFEO0FBRWIsWUFBQTs7WUFGYyxNQUFNO2dCQUFBLFdBQUEsRUFBWSxJQUFaOzs7UUFFcEIsSUFBQyxFQUFBLEVBQUEsRUFBRSxDQUFDLEtBQUosQ0FBQTtRQUNBLElBQUcsSUFBQyxFQUFBLEVBQUEsRUFBRSxDQUFDLGFBQUosQ0FBQSxDQUFIO1lBRUksVUFBQSxHQUFhLElBQUMsRUFBQSxFQUFBLEVBQUUsQ0FBQyxPQUFKLENBQUE7WUFDYixhQUFBLEdBQWdCLElBQUMsRUFBQSxFQUFBLEVBQUUsQ0FBQyxVQUFKLENBQUE7WUFDaEIsU0FBQSxHQUFZO0FBRVo7QUFBQSxpQkFBQSxxQ0FBQTs7Z0JBQ0ksSUFBRyxHQUFHLENBQUMsV0FBUDtvQkFDSSxJQUFBLEdBQU8sSUFBQyxDQUFBLGdDQUFELENBQWtDLENBQWxDLEVBQXFDLGFBQXJDLEVBRFg7aUJBQUEsTUFBQTtvQkFHSSxFQUFBLEdBQUssa0JBQUEsQ0FBbUIsQ0FBbkIsRUFBc0IsYUFBdEI7b0JBQ0wsSUFBRyxVQUFIO3dCQUNJLElBQUEsR0FBTyxDQUFDLGFBQUEsQ0FBYyxFQUFkLENBQUQsRUFB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QUNELEVBQUEsR0FBSyxXQUFBLENBQVksQ0FBQyxDQUFDLEtBQUYsQ0FBUSxHQUFSLENBQVosRUFESjtpQkFBQSxNQUFBO0FBR0QsMEJBSEM7O1lBTFQ7bUJBU0EsQ0FBQyxFQUFELEVBQUssRUFBTCxFQXJCSjs7SUFIOEIsQ0F0RWxDIiwic291cmNlc0NvbnRlbnQiOlsiXG4jIDAwMDAwMDAgICAgMDAwMDAwMDAgIDAwMCAgICAgICAgICAgICAwMDAwMDAwICAwMDAwMDAwMCAgMDAwICAgICAgMDAwMDAwMDAgICAwMDAwMDAwICAwMDAwMDAwMDAgIDAwMCAgIDAwMDAwMDAgICAwMDAgICAwMDBcbiMgMDAwICAgMDAwICAwMDAgICAgICAgMDAwICAgICAgICAgICAgMDAwICAgICAgIDAwMCAgICAgICAwMDAgICAgICAwMDAgICAgICAgMDAwICAgICAgICAgIDAwMCAgICAgMDAwICAwMDAgICAwMDAgIDAwMDAgIDAwMFxuIyAwMDAgICAwMDAgIDAwMDAwMDAgICAwMDAgICAgICAgICAgICAwMDAwMDAwICAgMDAwMDAwMCAgIDAwMCAgICAgIDAwMDAwMDAgICAwMDAgICAgICAgICAgMDAwICAgICAwMDAgIDAwMCAgIDAwMCAgMDAwIDAgMDAwXG4jIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgICAgICAgICAgICAgICAgMDAwICAwMDAgICAgICAgMDAwICAgICAgMDAwICAgICAgIDAwMCAgICAgICAgICAwMDAgICAgIDAwMCAgMDAwICAgMDAwICAwMDAgIDAwMDBcbiMgMDAwMDAwMCAgICAwMDAwMDAwMCAgMDAwMDAwMCAgICAgICAgMDAwMDAwMCAgIDAwMDAwMDAwICAwMDAwMDAwICAwMDAwMDAwMCAgIDAwMDAwMDAgICAgIDAwMCAgICAgMDAwICAgMDAwMDAwMCAgIDAwMCAgIDAwMFxuXG57IF8gfSA9IHJlcXVpcmUgJ2t4aycgXG5cbm1vZHVsZS5leHBvcnRzID1cbiAgICBcbiAgICBkZWxldGVTZWxlY3Rpb25PckN1cnNvckxpbmVzOiAtPlxuICAgICAgICBcbiAgICAgICAgQGRvLnN0YXJ0KClcbiAgICAgICAgaWYgbm90IEBkby5udW1TZWxlY3Rpb25zKClcbiAgICAgICAgICAgIEBzZWxlY3RNb3JlTGluZXMoKVxuICAgICAgICBAZGVsZXRlU2VsZWN0aW9uKClcbiAgICAgICAgQGRvLmVuZCgpXG5cbiAgICBkZWxldGVTZWxlY3Rpb246IChvcHQgPSBkZWxldGVMaW5lczp0cnVlKSAtPlxuXG4gICAgICAgIEBkby5zdGFydCgpXG4gICAgICAgIGlmIEBkby5udW1TZWxlY3Rpb25zKClcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICBuZXdDdXJzb3JzID0gQGRvLmN1cnNvcnMoKVxuICAgICAgICAgICAgb2xkU2VsZWN0aW9ucyA9IEBkby5zZWxlY3Rpb25zKClcbiAgICAgICAgICAgIGpvaW5MaW5lcyA9IFtdXG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGZvciBjIGluIEBkby5jdXJzb3JzKCkucmV2ZXJzZSgpXG4gICAgICAgICAgICAgICAgaWYgb3B0LmRlbGV0ZUxpbmVzXG4gICAgICAgICAgICAgICAgICAgIGNzZWwgPSBAY29udGludW91c1NlbGVjdGlvbkF0UG9zSW5SYW5nZXMgYywgb2xkU2VsZWN0aW9uc1xuICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgcmcgPSByYW5nZUF0UG9zSW5SYW5nZXMgYywgb2xkU2VsZWN0aW9uc1xuICAgICAgICAgICAgICAgICAgICBpZiByZz9cbiAgICAgICAgICAgICAgICAgICAgICAgIGNzZWwgPSBbcmFuZ2VTdGFydFBvcyhyZyksIHJhbmdlRW5kUG9zKHJnKV1cbiAgICAgICAgICAgICAgICBpZiBjc2VsP1xuICAgICAgICAgICAgICAgICAgICBbc3AsIGVwXSA9IGNzZWxcbiAgICAgICAgICAgICAgICAgICAgZm9yIG5jIGluIHBvc2l0aW9uc0JldHdlZW5Qb3NBbmRQb3NJblBvc2l0aW9ucyBzcCwgZXAsIG5ld0N1cnNvcnNcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnNvclNldCBuYywgc3BcbiAgICAgICAgICAgICAgICAgICAgaWYgc3BbMV0gPCBlcFsxXSBhbmQgc3BbMF0gPiAwIGFuZCBlcFswXSA8IEBkby5saW5lKGVwWzFdKS5sZW5ndGggXG4gICAgICAgICAgICAgICAgICAgICAgICAjIHNlbGVjdGlvbiBzcGFucyBtdWx0aXBsZSBsaW5lcyBhbmQgZmlyc3QgYW5kIGxhc3QgbGluZSBhcmUgY3V0XG4gICAgICAgICAgICAgICAgICAgICAgICBqb2luTGluZXMucHVzaCBzcFsxXVxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIG5jIGluIHBvc2l0aW9uc0FmdGVyTGluZUNvbEluUG9zaXRpb25zIGVwWzFdLCBlcFswXSwgbmV3Q3Vyc29yc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgc2V0IGN1cnNvcnMgYWZ0ZXIgc2VsZWN0aW9uIGluIGxhc3Qgam9pbmVkIGxpbmVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJzb3JTZXQgbmMsIHNwWzBdK25jWzBdLWVwWzBdLCBzcFsxXVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgZm9yIHMgaW4gQGRvLnNlbGVjdGlvbnMoKS5yZXZlcnNlKClcbiAgICAgICAgICAgICAgICBjb250aW51ZSBpZiBzWzBdID49IEBkby5udW1MaW5lcygpXG4gICAgICAgICAgICAgICAgbGluZVNlbGVjdGVkID0gc1sxXVswXSA9PSAwIGFuZCBzWzFdWzFdID09IEBkby5saW5lKHNbMF0pLmxlbmd0aFxuICAgICAgICAgICAgICAgIGlmIGxpbmVTZWxlY3RlZCBhbmQgb3B0LmRlbGV0ZUxpbmVzIGFuZCBAZG8ubnVtTGluZXMoKSA+IDFcbiAgICAgICAgICAgICAgICAgICAgQGRvLmRlbGV0ZSBzWzBdXG4gICAgICAgICAgICAgICAgICAgIGZvciBuYyBpbiBwb3NpdGlvbnNCZWxvd0xpbmVJbmRleEluUG9zaXRpb25zIHNbMF0sIG5ld0N1cnNvcnNcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnNvckRlbHRhIG5jLCAwLCAtMSAjIG1vdmUgY3Vyc29ycyBiZWxvdyBkZWxldGVkIGxpbmUgdXBcbiAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlIGlmIHNbMF0gPj0gQGRvLm51bUxpbmVzKClcbiAgICAgICAgICAgICAgICAgICAgQGRvLmNoYW5nZSBzWzBdLCBAZG8ubGluZShzWzBdKS5zcGxpY2Ugc1sxXVswXSwgc1sxXVsxXS1zWzFdWzBdXG4gICAgICAgICAgICAgICAgICAgIGZvciBuYyBpbiBwb3NpdGlvbnNBZnRlckxpbmVDb2xJblBvc2l0aW9ucyBzWzBdLCBzWzFdWzFdLCBuZXdDdXJzb3JzXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJzb3JEZWx0YSBuYywgLShzWzFdWzFdLXNbMV1bMF0pICMgbW92ZSBjdXJzb3JzIGFmdGVyIGRlbGV0aW9uIGluIHNhbWUgbGluZSBsZWZ0XG4gICAgICAgIFxuICAgICAgICAgICAgICAgIGlmIHNbMF0gaW4gam9pbkxpbmVzXG4gICAgICAgICAgICAgICAgICAgIEBkby5jaGFuZ2Ugc1swXSwgQGRvLmxpbmUoc1swXSkgKyBAZG8ubGluZShzWzBdKzEpXG4gICAgICAgICAgICAgICAgICAgIEBkby5kZWxldGUgc1swXSsxXG4gICAgICAgICAgICAgICAgICAgIGZvciBuYyBpbiBwb3NpdGlvbnNCZWxvd0xpbmVJbmRleEluUG9zaXRpb25zIHNbMF0sIG5ld0N1cnNvcnNcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnNvckRlbHRhIG5jLCAwLCAtMSAjIG1vdmUgY3Vyc29ycyBiZWxvdyBkZWxldGVkIGxpbmUgdXBcbiAgICAgICAgICAgICAgICAgICAgXy5wdWxsIGpvaW5MaW5lcywgc1swXVxuICAgICAgICAgICAgXG4gICAgICAgICAgICBAZG8uc2VsZWN0IFtdXG4gICAgICAgICAgICBAZG8uc2V0Q3Vyc29ycyBuZXdDdXJzb3JzXG4gICAgICAgICAgICBcbiAgICAgICAgICAgIEBlbmRTZWxlY3Rpb24oKSAjIHRoaXMgZG9lcyBjaGVja1NhbHRlck1vZGVcbiAgICAgICAgXG4gICAgICAgIEBkby5lbmQoKVxuXG4gICAgIyAgMDAwMDAwMCAgIDAwMDAwMDAgICAwMDAgICAwMDAgIDAwMDAwMDAwMCAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgIDAwMDAwMDAgICAwMDAgICAwMDAgICAwMDAwMDAwICBcbiAgICAjIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMDAgIDAwMCAgICAgMDAwICAgICAwMDAgIDAwMDAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAgIFxuICAgICMgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwIDAgMDAwICAgICAwMDAgICAgIDAwMCAgMDAwIDAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAwMDAwICAgXG4gICAgIyAwMDAgICAgICAgMDAwICAgMDAwICAwMDAgIDAwMDAgICAgIDAwMCAgICAgMDAwICAwMDAgIDAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgICAgICAgMDAwICBcbiAgICAjICAwMDAwMDAwICAgMDAwMDAwMCAgIDAwMCAgIDAwMCAgICAgMDAwICAgICAwMDAgIDAwMCAgIDAwMCAgIDAwMDAwMDAgICAgMDAwMDAwMCAgICAwMDAwMDAwICAgMDAwMDAwMCAgIFxuICAgICNcbiAgICAjIHJldHVybnMgc3RhcnQgYW5kIGVuZCBwb3NpdGlvbnMgb2YgcmFuZ2VzIHRoYXQgaGF2ZSBlaXRoZXIgbm8gY2hhcmFjdGVycyBvciBqdXN0IGEgc2luZ2xlIG5ld2xpbmUgYmV0d2VlbiB0aGVtXG5cbiAgICBjb250aW51b3VzU2VsZWN0aW9uQXRQb3NJblJhbmdlczogKHAsIHNlbCkgLT4gXG4gICAgICAgIFxuICAgICAgICByID0gcmFuZ2VBdFBvc0luUmFuZ2VzIHAsIHNlbFxuICAgICAgICBpZiByIGFuZCBsZW5ndGhPZlJhbmdlIHJcbiAgICAgICAgICAgIHNwID0gcmFuZ2VTdGFydFBvcyByXG4gICAgICAgICAgICB3aGlsZSAoc3BbMF0gPT0gMCkgYW5kIChzcFsxXSA+IDApXG4gICAgICAgICAgICAgICAgcGxyID0gQHJhbmdlRm9yTGluZUF0SW5kZXggc3BbMV0tMVxuICAgICAgICAgICAgICAgIHNpbCA9IHJhbmdlc0F0TGluZUluZGV4SW5SYW5nZXMgc3BbMV0tMSwgc2VsXG4gICAgICAgICAgICAgICAgaWYgc2lsLmxlbmd0aCA9PSAxIGFuZCBpc1NhbWVSYW5nZSBzaWxbMF0sIHBsclxuICAgICAgICAgICAgICAgICAgICBzcCA9IHJhbmdlU3RhcnRQb3MgcGxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiBzaWwubGVuZ3RoIGFuZCBfLmxhc3Qoc2lsKVsxXVsxXSA9PSBwbHJbMV1bMV1cbiAgICAgICAgICAgICAgICAgICAgc3AgPSByYW5nZVN0YXJ0UG9zIF8ubGFzdCBzaWxcbiAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgICBlcCA9IHJhbmdlRW5kUG9zIHJcbiAgICAgICAgICAgIHdoaWxlIChlcFswXSA9PSBAbGluZShlcFsxXSkubGVuZ3RoKSBhbmQgKGVwWzFdIDwgQG51bUxpbmVzKCktMSlcbiAgICAgICAgICAgICAgICBubHIgPSBAcmFuZ2VGb3JMaW5lQXRJbmRleCBlcFsxXSsxXG4gICAgICAgICAgICAgICAgc2lsID0gcmFuZ2VzQXRMaW5lSW5kZXhJblJhbmdlcyBlcFsxXSsxLCBzZWxcbiAgICAgICAgICAgICAgICBpZiBzaWwubGVuZ3RoID09IDEgYW5kIGlzU2FtZVJhbmdlIHNpbFswXSwgbmxyXG4gICAgICAgICAgICAgICAgICAgIGVwID0gcmFuZ2VFbmRQb3MgbmxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiBzaWwubGVuZ3RoIGFuZCBfLmZpcnN0KHNpbClbMV1bMF0gPT0gMFxuICAgICAgICAgICAgICAgICAgICBlcCA9IHJhbmdlRW5kUG9zIF8uZmlyc3Qgc2lsXG4gICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICBicmVhayAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICBbc3AsIGVwXVxuIl19
//# sourceURL=../../../coffee/editor/actions/deleteselection.coffee