###
000000000  00000000   0000000  000000000          000   000   0000000  000000000  00000000 
   000     000       000          000             000  000   000          000     000   000
   000     0000000   0000000      000             0000000    0000000      000     0000000  
   000     000            000     000             000  000        000     000     000   000
   000     00000000  0000000      000     000000  000   000  0000000      000     000   000
###

use .. â—† kstr

â–¸ kstr

    â–¸ str
    
        kstr a:1 b:2 â–¸ """a   1\nb   2"""
        kstr [1 2 3] â–¸ """1\n2\n3"""

    â–¸ encode
     
        kstr.encode(" hello / world !?")    â–¸ '%20hello%20/%20world%20!?'
        kstr.encode("</>")                  â–¸ '%3C/%3E'

    â–¸ escapeRegexp
        
        kstr.escapeRegexp('a/b.txt') â–¸ 'a\\/b\\.txt'
        
    #  0000000  000000000  00000000   000  00000000   
    # 000          000     000   000  000  000   000  
    # 0000000      000     0000000    000  00000000   
    #      000     000     000   000  000  000        
    # 0000000      000     000   000  000  000        
    
    â–¸ lstrip
        
        kstr.lstrip()                       â–¸ ''
        kstr.lstrip('')                     â–¸ ''
        kstr.lstrip('   y')                 â–¸ 'y'
        kstr.lstrip(' ')                    â–¸ ''
        kstr.lstrip('x ' 'x')               â–¸ ' '
        kstr.lstrip(' yxy ' ' y')           â–¸ 'xy '

    â–¸ rstrip
        
        kstr.rstrip()                       â–¸ ''
        kstr.rstrip('')                     â–¸ ''
        kstr.rstrip('   y' 'y')             â–¸ '   '
        kstr.rstrip(' ')                    â–¸ ''
        kstr.rstrip(' x' 'x')               â–¸ ' '
        kstr.rstrip(' yxy ' ' y')           â–¸ ' yx'

    â–¸ strip
        
        kstr.strip()                        â–¸ ''
        kstr.strip('')                      â–¸ ''
        kstr.strip('abc')                   â–¸ 'abc'
        kstr.strip('123   y  123' '123')    â–¸ '   y  '
        kstr.strip(' x y z ' 'xyz ')        â–¸ ''
        kstr.strip('x x' 'x')               â–¸ ' '
        kstr.strip(' yxy ' ' y')            â–¸ 'x'

    â–¸ trim
        
        kstr.trim('123   y  123' '123')     â–¸ '   y  '
        kstr.ltrim(' yxy ' ' y')            â–¸ 'xy '
        kstr.rtrim('   y' 'y')              â–¸ '   '
        
    # 000       0000000  000   000  000000000  
    # 000      000       0000  000     000     
    # 000      000       000 0 000     000     
    # 000      000       000  0000     000     
    # 0000000   0000000  000   000     000     
    
    â–¸ lcnt
        
        s = 'abc'
        n = 123
        kstr.lcnt()                      â–¸ 0
        kstr.lcnt(null, 'n')             â–¸ 0
        kstr.lcnt(undefined, 'u')        â–¸ 0
        kstr.lcnt(Infinity, 'Inf')       â–¸ 0
        kstr.lcnt({}, '{')               â–¸ 0
        kstr.lcnt([], '[')               â–¸ 0
        kstr.lcnt('' 1)                  â–¸ 0
        kstr.lcnt('ax' '')               â–¸ 0
        kstr.lcnt('' 'xy')               â–¸ 0
        kstr.lcnt('abc', Infinity)       â–¸ 0
        kstr.lcnt('abc' null)            â–¸ 0
        kstr.lcnt('abc' undefined)       â–¸ 0
        kstr.lcnt('abc' {})              â–¸ 0
        kstr.lcnt('abc' ['ab''b'])       â–¸ 0
        kstr.lcnt('abc' ['a''b'])        â–¸ 2
        kstr.lcnt(s, 'ac')               â–¸ 1
        kstr.lcnt(n, '13')               â–¸ 1
        kstr.lcnt(11202, '12')           â–¸ 3
        kstr.lcnt('   xx' ' ')           â–¸ 3
        kstr.lcnt('12345 blub' '1234')   â–¸ 4

    â–¸ rcnt
        
        s = 'abc'
        n = 123
        kstr.rcnt()                      â–¸ 0
        kstr.rcnt(null, 'n')             â–¸ 0
        kstr.rcnt(undefined, 'u')        â–¸ 0
        kstr.rcnt(Infinity, 'Inf')       â–¸ 0
        kstr.rcnt({}, '{')               â–¸ 0
        kstr.rcnt([], '[')               â–¸ 0
        kstr.rcnt('' 1)                  â–¸ 0
        kstr.rcnt('ax' '')               â–¸ 0
        kstr.rcnt('' 'xy')               â–¸ 0
        kstr.rcnt('abc', Infinity)       â–¸ 0
        kstr.rcnt('abc' null)            â–¸ 0
        kstr.rcnt('abc' undefined)       â–¸ 0
        kstr.rcnt('abc' {})              â–¸ 0
        kstr.rcnt('abc' ['ab''b'])       â–¸ 0
        kstr.rcnt('abc' ['c''b'])        â–¸ 2
        kstr.rcnt(s, 'ac')               â–¸ 1
        kstr.rcnt(n, '23')               â–¸ 2
        kstr.rcnt(11202, '02')           â–¸ 3
        kstr.rcnt('xx   ' ' ')           â–¸ 3
        kstr.rcnt('12345 blub' 'blub')   â–¸ 4
        kstr.rcnt('A4â”€â”€A5  ' ' ')        â–¸ 2
        
    # 00000000    0000000   0000000    
    # 000   000  000   000  000   000  
    # 00000000   000000000  000   000  
    # 000        000   000  000   000  
    # 000        000   000  0000000    
    
    â–¸ lpad
        
        kstr.lpad('' 4)        â–¸ '    '
        kstr.lpad('x' 4)       â–¸ '   x'
        kstr.lpad(' xxx ' 2)   â–¸ ' xxx '

    â–¸ rpad
        
        kstr.rpad('' 4)        â–¸ '    '
        kstr.rpad('x' 4)       â–¸ 'x   '
        kstr.rpad(' xxx ' 2)   â–¸ ' xxx '
 
    #  0000000   000   000   0000000  000  
    # 000   000  0000  000  000       000  
    # 000000000  000 0 000  0000000   000  
    # 000   000  000  0000       000  000  
    # 000   000  000   000  0000000   000  
    
    â–¸ ansi2html
         
        a2h = (s,r) -> kstr.ansi2html(s) â–¸ r

        a2h 'hello', 'hello'
        a2h r5('red'), '<span style="color:#ff0000;">red</span>'
        a2h """
            #{r5('red')}
            #{g5('green')}
            """ """
            <span style="color:#ff0000;">red</span>
            <span style="color:#00ff00;">green</span>
            """
        a2h "#{r5('red')}#{g5('green')}", '<span style="color:#ff0000;">red</span><span style="color:#00ff00;">green</span>'
        
    â–¸ stripAnsi
         
        kstr.stripAnsi(g5('green')) â–¸ 'green'
         
    â–¸ dissect
         
        ansi= new kstr.ansi
        diss = ansi.dissect '[48;5;0m..[48;5;15m  [0m'
        diss[0] â–¸ '..  '
        diss[1].length â–¸ 2
        diss[1][1].match â–¸ '  '
        diss[1][1].start â–¸ 2
        
    # 000000000   0000000   0000000    
    #    000     000   000  000   000  
    #    000     000000000  0000000    
    #    000     000   000  000   000  
    #    000     000   000  0000000    
    
    â–¸ detab
        
        kstr.detab('\t\t') â–¸ '        '
        kstr.detab('aa\tbb') â–¸ 'aa  bb'
       
    # 000000000  000  00     00  00000000  
    #    000     000  000   000  000       
    #    000     000  000000000  0000000   
    #    000     000  000 0 000  000       
    #    000     000  000   000  00000000  
    
    â–¸ time number
        
        kstr.time 1                     â–¸ '1 ms'
        kstr.time 1000                  â–¸ '1 second'
        kstr.time 1001                  â–¸ '1 second'
        kstr.time 1999                  â–¸ '1 second'
        kstr.time 2000                  â–¸ '2 seconds'
        kstr.time 2001                  â–¸ '2 seconds'
        kstr.time 59999                 â–¸ '59 seconds'
        kstr.time 60000                 â–¸ '1 minute'
        kstr.time 120001                â–¸ '2 minutes'
        kstr.time 1000*60*60            â–¸ '1 hour'
        kstr.time 1000*60*60*24         â–¸ '1 day'
        kstr.time 1000*60*60*48         â–¸ '2 days'
        kstr.time 1000*60*60*24*30      â–¸ '1 month'
        kstr.time 1000*60*60*24*60      â–¸ '2 months'
        kstr.time 1000*60*60*24*30*12   â–¸ '1 year'
        kstr.time 1000*60*60*24*30*24   â–¸ '2 years'
        
    â–¸ time bigint
        
        kstr.time BigInt(1)             â–¸ '1 ns'
        kstr.time BigInt(1000)          â–¸ '1 Î¼s'
        kstr.time BigInt(1001)          â–¸ '1 Î¼s'
        kstr.time BigInt(6001)          â–¸ '6 Î¼s'
        kstr.time BigInt(1000000)       â–¸ '1 ms'
        kstr.time BigInt(1000000000)    â–¸ '1 second'
        kstr.time BigInt(2000000000)    â–¸ '2 seconds'
        
    # 00000000  000  000      000      00000000  000000000  
    # 000       000  000      000      000          000     
    # 000000    000  000      000      0000000      000     
    # 000       000  000      000      000          000     
    # 000       000  0000000  0000000  00000000     000     
    
    â–¸ fillet
    
        kstr.fillet() â–¸ []
        kstr.fillet '' â–¸ []
        kstr.fillet ' ' â–¸ []
        kstr.fillet '\t' â–¸ []
        kstr.fillet '\n' â–¸ []
        kstr.fillet '\r' â–¸ []
        kstr.fillet '   ' â–¸ []
        kstr.fillet ' \n \t \r' â–¸ []
        kstr.fillet 'abc' â–¸ [{match:'abc' index:0 length:3 word:true}]
        kstr.fillet 'a b c' â–¸ [{match:'a' index:0 length:1 word:true}, {match:'b' index:2 length:1 word:true}, {match:'c' index:4 length:1 word:true}]
        kstr.fillet ' abc.def ' â–¸ [{match:'abc' index:1 length:3 word:true}, {match:'.' index:4 length:1 word:false}, {match:'def' index:5 length:3 word:true}]
        kstr.fillet ' a_c.,:__def ' â–¸ [{match:'a_c' index:1 length:3 word:true}, {match:'.,:' index:4 length:3 word:false}, {match:'__def' index:7 length:5 word:true}]
        kstr.fillet '1-2' â–¸ [{match:'1' index:0 length:1 word:true}, {match:'-' index:1 length:1 word:false}, {match:'2' index:2 length:1 word:true}]
        
    â–¸ unfillet
    
        kstr.unfillet kstr.fillet(' a_c.,:__def ') â–¸ 'a_c.,:__def'
        
    â–¸ blockFillets
    
        text = """
            hello
                world
            """
        lines = text.split '\n'
        lineFillets = lines.map (line) -> kstr.fillet line
        
        blockFillets = kstr.blockFillets lineFillets
        blockFillets â–¸ [
            line:   0
            indent: 0
            fillet: [
                match:   'hello'
                index:   0
                length:  5
                word:    true
                ] 
            blocks: [
                line:  1
                indent: 4
                fillet: [
                    match:  'world'
                    index:  4
                    length:  5
                    word:  true
                    ]
                blocks: []
                ]
            ]
            
        â–¸ unfilletBlocks 
        
            r = kstr.unfilletBlocks blockFillets
            r â–¸ text + '\n'

    #  0000000  000   000  000   000  000   000  000   000    
    # 000       000   000  000   000  0000  000  000  000     
    # 000       000000000  000   000  000 0 000  0000000      
    # 000       000   000  000   000  000  0000  000  000     
    #  0000000  000   000   0000000   000   000  000   000    
    
    â–¸ indexOfClosestNonWS    
    
        kstr.indexOfClosestNonWS ''         0       â–¸ -1
        kstr.indexOfClosestNonWS '     '    2       â–¸ -1
        kstr.indexOfClosestNonWS null       2       â–¸ -1
        kstr.indexOfClosestNonWS undefined  2       â–¸ -1
        kstr.indexOfClosestNonWS 'hello  '  0       â–¸ 0
        kstr.indexOfClosestNonWS '  llo  '  0       â–¸ 2
        kstr.indexOfClosestNonWS '  llo  '  2       â–¸ 2
        kstr.indexOfClosestNonWS '  llo  '  3       â–¸ 3
        kstr.indexOfClosestNonWS '  llo  '  4       â–¸ 4
        kstr.indexOfClosestNonWS '  llo  '  5       â–¸ 4
        kstr.indexOfClosestNonWS '  llo  '  6       â–¸ 4
        kstr.indexOfClosestNonWS '  l  '    0       â–¸ 2
        kstr.indexOfClosestNonWS '  l  '    -1      â–¸ 2
        kstr.indexOfClosestNonWS '  l  '    2       â–¸ 2
        kstr.indexOfClosestNonWS '  l  '    100     â–¸ 2
        kstr.indexOfClosestNonWS ' 1    6   a  ' 0  â–¸ 1
        kstr.indexOfClosestNonWS ' 1    6   a  ' 1  â–¸ 1
        kstr.indexOfClosestNonWS ' 1    6   a  ' 2  â–¸ 1
        kstr.indexOfClosestNonWS ' 1    6   a  ' 3  â–¸ 1
        kstr.indexOfClosestNonWS ' 1    6   a  ' 4  â–¸ 6
        kstr.indexOfClosestNonWS ' 1    6   a  ' 5  â–¸ 6
        kstr.indexOfClosestNonWS ' 1    6   a  ' 6  â–¸ 6
        kstr.indexOfClosestNonWS ' 1    6   a  ' 7  â–¸ 6
        kstr.indexOfClosestNonWS ' 1    6   a  ' 8  â–¸ 10
        kstr.indexOfClosestNonWS ' 1    6   a  ' 9  â–¸ 10
        kstr.indexOfClosestNonWS ' 1    6   a  ' 10 â–¸ 10
        
    â–¸ rangeOfClosestChunk
    
        kstr.rangeOfClosestChunk ''         0    â–¸ [-1 -1]
        kstr.rangeOfClosestChunk '     '    2    â–¸ [-1 -1]
        kstr.rangeOfClosestChunk null       2    â–¸ [-1 -1]
        kstr.rangeOfClosestChunk undefined  2    â–¸ [-1 -1]
        
        kstr.rangeOfClosestChunk '  word '  -2   â–¸ [2 5]
        kstr.rangeOfClosestChunk '  word '  0    â–¸ [2 5]
        kstr.rangeOfClosestChunk '  word '  1    â–¸ [2 5]
        kstr.rangeOfClosestChunk '  word '  2    â–¸ [2 5]
        kstr.rangeOfClosestChunk '  word '  5    â–¸ [2 5]
        kstr.rangeOfClosestChunk '  word '  7    â–¸ [2 5]
        kstr.rangeOfClosestChunk '  word '  100  â–¸ [2 5]
        
        kstr.rangeOfClosestChunk '  hello   word !'  0    â–¸ [2 6]
        kstr.rangeOfClosestChunk '  hello   word !'  2    â–¸ [2 6]
        kstr.rangeOfClosestChunk '  hello   word !'  7    â–¸ [2 6]
        kstr.rangeOfClosestChunk '  hello   word !'  8    â–¸ [10 13]
        kstr.rangeOfClosestChunk '  hello   word !'  9    â–¸ [10 13]
        kstr.rangeOfClosestChunk '  hello   word !'  14   â–¸ [15 15]
        kstr.rangeOfClosestChunk '  hello   word !'  15   â–¸ [15 15]
        kstr.rangeOfClosestChunk '  hello   word !'  100  â–¸ [15 15]
        
    # 000   000   0000000   00000000   0000000      
    # 000 0 000  000   000  000   000  000   000    
    # 000000000  000   000  0000000    000   000    
    # 000   000  000   000  000   000  000   000    
    # 00     00   0000000   000   000  0000000      
    
    â–¸ isAlphaNumeric
    
        kstr.isAlphaNumeric 'A'     â–¸ true
        kstr.isAlphaNumeric 'a'     â–¸ true
        kstr.isAlphaNumeric '1'     â–¸ true
        kstr.isAlphaNumeric '0'     â–¸ true
        kstr.isAlphaNumeric '_'     â–¸ true
        kstr.isAlphaNumeric ' '     â–¸ false
        kstr.isAlphaNumeric '@'     â–¸ false
        kstr.isAlphaNumeric "#"     â–¸ false
        kstr.isAlphaNumeric "{"     â–¸ false
        kstr.isAlphaNumeric "+"     â–¸ false
        kstr.isAlphaNumeric "-"     â–¸ false
        kstr.isAlphaNumeric "="     â–¸ false
        kstr.isAlphaNumeric '.'     â–¸ false
        kstr.isAlphaNumeric 'a_1'   â–¸ true
        kstr.isAlphaNumeric '981'   â–¸ true
        kstr.isAlphaNumeric '9.1'   â–¸ false
        kstr.isAlphaNumeric 'a.1'   â–¸ false
        kstr.isAlphaNumeric ' a_1 ' â–¸ false
        
    â–¸ rangeOfClosestWord 
    
        kstr.rangeOfClosestWord ''         0    â–¸ [-1 -1]
        kstr.rangeOfClosestWord '     '    2    â–¸ [-1 -1]
        kstr.rangeOfClosestWord null       2    â–¸ [-1 -1]
        kstr.rangeOfClosestWord undefined  2    â–¸ [-1 -1]
    
        kstr.rangeOfClosestWord '  word '  -2   â–¸ [2 5]
        kstr.rangeOfClosestWord '  word '  0    â–¸ [2 5]
        kstr.rangeOfClosestWord '  word '  1    â–¸ [2 5]
        kstr.rangeOfClosestWord '  word '  2    â–¸ [2 5]
        kstr.rangeOfClosestWord '  word '  5    â–¸ [2 5]
        kstr.rangeOfClosestWord '  word '  7    â–¸ [2 5]
        kstr.rangeOfClosestWord '  word '  100  â–¸ [2 5]
        
        kstr.rangeOfClosestWord '  hello   word !'  0    â–¸ [2 6]
        kstr.rangeOfClosestWord '  hello   word !'  2    â–¸ [2 6]
        kstr.rangeOfClosestWord '  hello   word !'  7    â–¸ [2 6]
        kstr.rangeOfClosestWord '  hello   word !'  8    â–¸ [10 13]
        kstr.rangeOfClosestWord '  hello   word !'  9    â–¸ [10 13]
        kstr.rangeOfClosestWord '  hello   word !'  14   â–¸ [10 13]
        kstr.rangeOfClosestWord '  hello   word !'  15   â–¸ [10 13]
        # kstr.rangeOfClosestWord '  hello   word !'  100  â–¸ [10 13]
        
    â–¸ indexOfClosestAlphaNumeric
    
        kstr.indexOfClosestAlphaNumeric '  hello   word !'  8  â–¸ 10
        kstr.indexOfClosestAlphaNumeric '  hello   word !'  15 â–¸ 13
        